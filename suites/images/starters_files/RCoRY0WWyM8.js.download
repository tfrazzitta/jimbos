if (self.CavalryLogger) { CavalryLogger.start_js(["Cpnks"]); }

__d("XFeedNUXSaveSeenStateController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/feed/nux/seen/save/",{link_id:{type:"String"},key:{type:"String",required:!0},seen:{type:"Bool",defaultValue:!1},env:{type:"Enum",enumType:0}})}),null);
__d("MFeedNUXTooltip",["DOM","MRequest","MViewport","Stratcom","SubscriptionsHandler","XFeedNUXSaveSeenStateController","destroyOnUnload","mixInEventEmitter"],(function(a,b,c,d,e,f){__p&&__p();var g={},h,i={},j,k=0,l=100,m=1,n=0;function o(){h=b("Stratcom").listen("scroll",null,q),b("destroyOnUnload")(p)}function p(){h&&h.remove(),h=null,window.clearTimeout(j),j=null}function q(){__p&&__p();var a=b("MViewport").getHeight();j&&(window.clearTimeout(j),j=null);for(var c in g){var d=g[c],e=d.getNodes(),f=d.getHeadRoom();for(var h=0;h<e.length;h++){var i=e[h].getBoundingClientRect();if(i.top>=f&&i.bottom<=a){r(e[h],d);break}}}}function r(a,b){j=window.setTimeout(function(){b.getContext()!==a&&(b.setContext(a),b.show())},k)}a=function(){"use strict";__p&&__p();function a(a,c,d,e){__p&&__p();g.length||o();if(g[c]||i[c]){d.destroy();return}this.$1=c;this.$2=b("DOM").scry(document.getElementById("page"),"*",a);this.$3=a;this.$4=n;this.$5=d;this.$6=e===0?0:e||l;g[c]=this;var f=new(b("SubscriptionsHandler"))();f.addSubscriptions(this.$5.addListener("show",this.emit.bind(this,"show")),this.$5.addListener("hide",function(){this.emit("hide"),f.release()}.bind(this)));q()}var c=a.prototype;c.destroy=function(){delete g[this.$1],Object.keys(g).length||p()};c.getContext=function(){return this.$5.getContext()};c.getNodes=function(){return this.$2};c.getHeadRoom=function(){return this.$6};c.getIsUnseen=function(){return this.$4===n};c.setContext=function(a){this.$5&&this.$5.setContext(a)};c.show=function(){if(!this.$5||this.$4===m)return;i[this.$1]=!0;this.$4=m;this.$5.show();var a=b("XFeedNUXSaveSeenStateController").getURIBuilder().setString("key",this.$1).setBool("seen",!0);new(b("MRequest"))(a.getURI()).setMethod("POST").send();this.destroy()};c.hide=function(){this.$5&&this.$5.hide()};return a}();b("mixInEventEmitter")(a,{show:!0,hide:!0});e.exports=a}),null);
__d("MFeedReactionsNUX",["BanzaiLogger","MLegacyDataStore","MLiveData","Stratcom","SubscriptionsHandler","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){__p&&__p();var d=c&&c.isCommentNUX;if(a){var e=new(b("SubscriptionsHandler"))();e.addSubscriptions(b("Stratcom").listen("click","like-reaction-flyout",function(c){__p&&__p();var f=c.getNode("like-reaction-flyout"),h=c.getNode("feed-ufi-comments");if(!f||h)return;h=b("MLegacyDataStore").get(f);if(d&&!h.isComment||!d&&h.isComment)return;var i=h.feedback_target||h.feedbackTarget;if(i){var j=b("MLiveData").get(i);e.addSubscriptions(j.listen("change",function(){j.getData().has_viewer_liked&&b("requestAnimationFrame")(function(){a.setContext(c.getTarget()),a.show(),g(i)})}))}}),a.once("hide",function(){e.release()}));d||e.addSubscriptions(b("Stratcom").listen("click","reactions-bling-bar",function(c){var d=c.getNode("mufi-inline").querySelector('a[data-sigil*="like-reaction-flyout"]');if(d){var e=c.getNode("feed-ufi-metadata");e=b("MLegacyDataStore").get(e).feedback_target.toString();g(e);a.setContext(d);a.show();c.kill()}}));b("Stratcom").listen("m:page:unload",null,function(){b("Stratcom").removeCurrentListener(),e.release()})}}function g(a){b("BanzaiLogger").log("WebReactionsNuxLoggerConfig",{feedback_id:a,"interface":"mTouch"})}e.exports.init=a}),null);
__d("ViewportTrackingHooks",["Base64"],(function(a,b,c,d,e,f){__p&&__p();var g={},h=[];a={registerFeedObject:function(a,c){g[a]=b("Base64").encode(c)},updateVisibleViewportObjects:function(a){var b=[],c=!1;for(var d=0;d<a.length;d++){var e=a[d],f=e.id;while(!(f in g)&&e.firstChild!=void 0&&e.firstChild.id!=void 0&&e.firstChild.id.startsWith("u_"))f=e.firstChild.id,e=e.firstChild;f in g&&(b.push(g[f]),(!(d in h)||h[d]!=g[f])&&(c=!0))}!c&&h.length!=b.length&&(c=!0);c&&(h=b,typeof __EXT__updateVisibleViewportObjects==="function"&&__EXT__updateVisibleViewportObjects(h))}};e.exports=a}),null);
__d("MViewportTracking",["invariant","DataAttributeUtils","DOM","FBJSON","MPageController","MPopoverVisiblityTracker","MViewport","NavigationMetrics","Stratcom","Style","Vector","ViewportTrackingHooks","Visibility","VisibilityTrackingHelper","gkx","onAfterTTI","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=97,i=200,j=new Map();a=function(){__p&&__p();function a(){this.$2=[],this.debugConsole=!1,this.activeStories={},this.cachedViewportHeight=0,this.discardVPVDIntervalThreshold=9e4,this.isLoose=!1,this.isTimeTrackingEnabled=!1,this.latestTimeTrackingTimestamp=0,this.maxScrollPosition=0,this.minSizeToBeVisible=0,this.readStoryIDs={},this.relaxedMinSize=!1,this.throttleNoDelay=!1,this.trackingHooks=!1,this.vpvdDebug=!1,this.vpvDebug=!1,this.enableAdsAllocationIntegrityLogging=!1}var c=a.prototype;c.getDataFromConfig=function(a){g(0,2199)};c.getStoryID=function(a){g(0,2200)};c.getDataToLog=function(a){g(0,2201)};c.sendDataToLog=function(a){g(0,2202)};c.getTimeout=function(){g(0,2203)};c.getAllStories=function(){g(0,2204)};c.init=function(c){__p&&__p();var d=this;this.isLoose=!!c.is_loose;this.throttleNoDelay=!!c.throttle_no_delay;this.relaxedMinSize=!!c.relaxed_min_size;this.vpvDebug=!!c.vpv_debug;this.trackingHooks=!!c.tracking_hooks;this.isTimeTrackingEnabled=!1;var e=a.shouldRunTrackingAfterTTI();b("MPopoverVisiblityTracker").init();e||(this.cachedViewportHeight=b("MViewport").getHeight());this.getDataFromConfig(c);this.maxScrollPosition=0;this.readStoryIDs=this.getCachedReadStoryIDs()||{};this.$2=[b("Stratcom").listen("m:page:unload",null,this.onUnload.bind(this)),b("Stratcom").listen("m:viewport:update-complete",null,function(){d.cachedViewportHeight=b("MViewport").getHeight()})];c.triggerOverride?this.$2=this.$2.concat(c.triggerOverride.map(function(a){var c=a[0];a=a[1];return b("Stratcom").listen(c,a,d.queueLogAction.bind(d))})):this.$2.push(b("Stratcom").listen("scroll",null,this.queueLogAction.bind(this)));this.isTimeTrackingEnabled&&(this.$2.push(b("Visibility").addListener(b("Visibility").VISIBLE,function(){return d.startRecordingTimeTrackingData()})),this.$2.push(b("Visibility").addListener(b("Visibility").HIDDEN,function(){return d.stopRecordingTimeTrackingData()})));this.$2.push(b("Stratcom").listen("m:newsfeed:popup-visible",null,function(){d.stopRecordingTimeTrackingData()}),b("Stratcom").listen("m:newsfeed:popup-hidden",null,function(){d.startRecordingTimeTrackingData(),d.fireEvent()}));e?b("onAfterTTI")(function(){d.fireEvent()},!1):(this.fireEvent(),b("NavigationMetrics").addRetroactiveListener(b("NavigationMetrics").Events.EVENT_OCCURRED,function(a,c){a=c.event;a==="tti"&&(d.fireEvent(),b("NavigationMetrics").removeCurrentListener())}))};c.getFBFeedLocation=function(){return-1};c.unitTestOnlyGetListeners=function(){return[].concat(this.$2)};c.getCachedReadStoryIDs=function(){return null};c.getMinSizeToBeVisible=function(a){if(!this.relaxedMinSize)return i;a="getBoundingClientRect"in a?a.getBoundingClientRect().height:b("Vector").getDim(a).y;return Math.min(i,a*.5)};c.fireEvent=function(){__p&&__p();if(b("VisibilityTrackingHelper").isSnippetFlyoutVisible())return;var a=this.getAllStoriesInView();for(var c=0;c<a.length;c++){var d=a[c],e=this.getStoryID(d);if(!e||e in this.readStoryIDs)continue;this.readStoryIDs[e]=!0;this.sendDataToLog(this.getDataToLog(d));if(this.vpvDebug){e=b("DOM").scry(d,"div")[0];e&&b("Style").set(e,"background-color","#fffbe2")}this.markStoryRead(d);this.fireStoryVisibleHandlers(d)}this.trackingHooks&&b("ViewportTrackingHooks").updateVisibleViewportObjects(this.getAllStoriesInView(!0))};c.fireStoryVisibleHandlers=function(a){(j.get(a)||[]).forEach(function(a){return a()}),j["delete"](a)};c.markStoryRead=function(a){};c.queueLogAction=function(){var a=this;this.isLoose?this.$3||(this.$3=b("setTimeoutAcrossTransitions")(function(){a.isTimeTrackingEnabled&&a.startRecordingTimeTrackingData(),a.$3=null,a.maxScrollPosition=Math.max(a.maxScrollPosition,b("MViewport").getScrollTop()),!a.throttleNoDelay?(clearTimeout(a.$1),a.$1=b("setTimeoutAcrossTransitions")(function(){return a.fireEvent()},a.getTimeout())):a.fireEvent()},100)):(clearTimeout(this.$1),this.$1=b("setTimeoutAcrossTransitions")(function(){a.isTimeTrackingEnabled&&a.startRecordingTimeTrackingData(),a.fireEvent()},this.getTimeout()))};c.getTimetrackingDataToLog=function(c){var d=b("DOM").scry(c.story,"*","data-is-cta").map(function(a){a=b("DataAttributeUtils").getDataFt(a);a=a&&JSON.parse(a);return a&&a.cta_types}).filter(function(a){return!!a});this.cachedViewportHeight===0&&a.shouldRunTrackingAfterTTI()&&(this.cachedViewportHeight=b("MViewport").getHeight());return{evt:h,fbfeed_location:this.getFBFeedLocation(),story_height:c.story_height,viewport_height:this.cachedViewportHeight,vpvd_start_timestamp:c.evp_ts/1e3,vpvd_time_delta:Math.round(c.vpvd||0),cta_types:d}};c.recordTimeStoryWasInView=function(a){if(this.isTimeTrackingEnabled&&a.vpvd>0){var c=this.getTimetrackingDataToLog(a);if(typeof c!=="string"){a=b("DataAttributeUtils").getDataFt(a.story);a&&(c=babelHelpers["extends"]({},c,b("FBJSON").parse(a,e.id)))}this.sendTimetrackingDataToLog(c)}};c.startRecordingTimeTrackingData=function(){this.$4(!1)};c.stopRecordingTimeTrackingData=function(){this.$4(!0)};c.$4=function(a){__p&&__p();this.activeStories||(this.activeStories={});var b=Date.now();this.latestTimeTrackingTimestamp||(this.latestTimeTrackingTimestamp=b);var c=this.getAllStoriesInView();this.updateVPVDurations(b);if(this.debugConsole){var d=Object.values(this.activeStories);d.length&&(console.table&&console.table(d))}d=this.updateActiveStories(c,b);this.debugConsole&&(d.length&&(console.table&&console.table(d)));this.recordVPVDurations(c,a);this.latestTimeTrackingTimestamp=a?0:b};c.updateVPVDurations=function(a){var b=a-this.latestTimeTrackingTimestamp;if(b>this.discardVPVDIntervalThreshold)return;b=a-this.latestTimeTrackingTimestamp;for(var c in this.activeStories)Object.prototype.hasOwnProperty.call(this.activeStories,c)&&(this.activeStories[c].vpvd+=b)};c.isVisible=function(a,b){for(var c=0;c<b.length;c++)if(this.getStoryID(b[c])===a)return!0;return!1};c.recordVPVDurations=function(a,b){this.recordVPVDurationsInternal(a,b)};c.recordVPVDurationsInternal=function(a,b){for(var c in this.activeStories)Object.prototype.hasOwnProperty.call(this.activeStories,c)&&((b||!this.isVisible(c,a))&&(this.recordTimeStoryWasInView(this.activeStories[c]),delete this.activeStories[c]))};c.updateActiveStories=function(a,b){var c=[];for(var d=0;d<a.length;d++){var e=this.getStoryID(a[d]);if(!e)break;e in this.activeStories||(this.activeStories[e]={evp_ts:b,story:a[d],vpvd:0,story_height:a[d].offsetHeight},c.push(this.activeStories[e]));this.activeStories[e].ts=b}return c};c.getAllStoriesInView=function(a){__p&&__p();a===void 0&&(a=!1);var c=[],d=this.getAllStories(),e=b("MViewport").getScrollTop(),f=b("MViewport").getHeight(),g=this.isLoose,h=f+this.maxScrollPosition-e;for(var i=0;i<d.length;i++){var j=d[i],k=this.getStoryBounds(e,j),l=k.top;k=k.bottom;if(!l&&!k)continue;var m=this.getMinSizeToBeVisible(j);if(!g&&l>f-m)break;m=!g&&l<=f-m&&k>=m||g&&l<h;a&&(k<0||l>f)&&(m=!1);m&&c.push(j)}return c};c.getStoryBounds=function(a,c){if("getBoundingClientRect"in c){var d=c.getBoundingClientRect();return{bottom:d.bottom,top:d.top}}else{d=b("Vector").getPos(c).y-a;return{top:d,bottom:d+b("Vector").getDim(c).y}}};c.cleanup=function(){this.$2.forEach(function(a){return a.remove()}),this.$2=[],j.clear()};c.onUnload=function(){this.isTimeTrackingEnabled&&this.stopRecordingTimeTrackingData(),this.cleanup()};c.sendTimetrackingDataToLog=function(a){this.sendDataToLog(a)};a.shouldRunTrackingAfterTTI=function(){return b("MPageController").isHomeishPath(location.href)&&b("gkx")("676812")};a.addStoryVisibleHandler=function(a,b){j.set(a,[].concat(j.get(a)||[],[b]));return{remove:function(){j.set(a,(j.get(a)||[]).filter(function(a){return a!==b}))}}};return a}();e.exports=a}),null);
__d("MCommentViewportTracking",["Banzai","DataStore","DOM","FBJSON","MParent","MViewportTracking","Stratcom","StratcomManager","compactArray","gkx","onAfterTTI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=null,h={m_group_stories_container:"group",m_newsfeed_stream:"",m_story_permalink_view:"",structured_composer_async_container:"user",root:""};a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}c.loadedReplies=function(){b("Stratcom").invoke("m:commentViewportTracking:loadedReplies")};c.loadedComments=function(){g&&g.isTimeTrackingEnabled&&g.startRecordingTimeTrackingData()};c.singleton=function(a){__p&&__p();if(!g){a={triggerOverride:[["scroll",null],["m:commentViewportTracking:loadedReplies",null],["m:feed-ufi-flyout:comments-displayed",null],["m:ufi:live-comments:render",null],["m:ufi:live-comments:new-comment",null],["m:feed-ufi-flyout:reset",null],["m:page:render:complete",null]]};b("StratcomManager").enableDispatch(document,"scroll");g=new c();g.init(a);g.debugConsole;g.isTimeTrackingEnabled&&(b("MViewportTracking").shouldRunTrackingAfterTTI()?b("onAfterTTI")(function(){g instanceof c&&g.startRecordingTimeTrackingData()},!1):g.startRecordingTimeTrackingData());b("Stratcom").listen("m:page:unload",null,function(){g=null,b("Stratcom").removeCurrentListener()})}};c.registerFlyout=function(a,b){var c;g&&(g.debugConsole,g.streamRoot=a);h=babelHelpers["extends"]((c={},c[a.id]=b||"",c),h)};var d=c.prototype;d.getDataFromConfig=function(){this.debugConsole=b("gkx")("676811"),this.isTimeTrackingEnabled=!0,this.idle_timeout=5e3,this.min_duration_to_log=100,this.min_visible_size=200,this.relaxedMinSize=!0};d.__getRootNode=function(){this.streamRoot||(this.streamRoot=b("compactArray")(Object.keys(h).map(function(a){return document.getElementById(a)}))[0]||null);return this.streamRoot};d.__getStaticTemplateRootNode=function(){this.staticElementRoot||(this.staticElementRoot=document.getElementById("static_templates"));return this.staticElementRoot};d.getAllStories=function(){var a=this.__getRootNode();if(!a)return[];a=b("DOM").scry(this.__getRootNode(),"div","comment-body");return this.__getStaticTemplateRootNode()?a.concat(b("DOM").scry(this.__getStaticTemplateRootNode(),"div","comment-body")):a};d.getTimeout=function(){return this.min_duration_to_log};d.getDataToLog=function(a){return{}};d.getStoryID=function(a){var c=a.getAttribute("data-commentid");return!c?String(b("DataStore").get(a,"token"))||null:c};d.getContainerModule=function(){var a=this.__getRootNode();return!a||!(a.id in h)?"other":h[a.id]};d.getTimetrackingDataToLog=function(a){var c=a.story,d;try{var f=b("MParent").bySigil(a.story,"story-div")||b("MParent").bySigil(a.story,"m-feed-single-story");f&&(d=b("FBJSON").parse(f.getAttribute("data-ft"),e.id))}catch(a){}return{comment_id:this.getStoryID(c),duration_ms:Math.round(a.vpvd),container_module:this.getContainerModule(),mf_story_key:d?d.mf_story_key||d.top_level_post_id:null}};d.sendDataToLog=function(a){if(a.comment_id){this.debugConsole;var c=b("Banzai").isEnabled("comment_vpv_vital")?b("Banzai").VITAL:null;b("Banzai").post("comment_vpvd",a,c)}};return c}(b("MViewportTracking"));e.exports=a}),null);
__d("XStoryChevronController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/story_chevron_menu/",{feedobjects_identifiers:{type:"String"},feed_context:{type:"String"},chevron_button_id:{type:"String"},story_node_id:{type:"String"},zombie_story:{type:"String"},is_menu_registered:{type:"Bool",defaultValue:!1},outer_story_token:{type:"String"},show_report_ad_only:{type:"Bool",defaultValue:!1}})}),null);
__d("MAsyncChevronMenu",["cx","BanzaiODS","CSS","DOM","MLegacyDataStore","MParent","MRequest","MTouchClick","Stratcom","SubscriptionsHandler","XStoryChevronController","$","requireWeak"],(function(a,b,c,d,e,f,g){__p&&__p();var h=null;b("requireWeak")("MHideStoryActions",function(a){return h=a});var i,j,k,l,m,n,o;function p(a){a=b("MParent").bySigil(a,"story-popup-metadata");return a}function q(){__p&&__p();b("BanzaiODS").bumpEntityKey("mtouch_async_chevron","chevron_clicked");var a=this.getCausalElement(),c=b("MLegacyDataStore").get(a),d=p(a),e=b("XStoryChevronController").getURIBuilder().setBool("is_menu_registered",!!(h&&h.getActionBubble())).getURI();e=new(b("MRequest"))(e);l&&b("CSS").show(l);m&&b("CSS").hide(m);n&&b("CSS").hide(n);i=d;e.setMethod("POST");e.setData({feedobjects_identifiers:c.feedobjectsIdentifiers,feed_context:c.feedContext,zombie_story:c.zombieStoryURI?c.zombieStoryURI:"",story_node_id:d&&d.id,chevron_button_id:a.id,outer_story_token:c.outerStoryToken?c.outerStoryToken:"",show_report_ad_only:o});e.listen("error",function(a){b("BanzaiODS").bumpEntityKey("mtouch_async_chevron","request_failed"),l&&b("CSS").hide(l),a=="status=0"?(b("BanzaiODS").bumpEntityKey("mtouch_async_chevron","request_failed_no_internet_connection"),m&&b("CSS").show(m),n&&b("CSS").hide(n)):(b("BanzaiODS").bumpEntityKey("mtouch_async_chevron","request_failed_server_side_error"),n&&b("CSS").show(n),m&&b("CSS").hide(m))});e.listen("done",function(){b("BanzaiODS").bumpEntityKey("mtouch_async_chevron","request_done")});e.send()}function r(){k&&(k.release(),k=null),j=null,l=null,m=null,n=null}function s(){if(j){var a=j.getContentRoot();l=b("DOM").find(a,"div","loadingWrapper");m=b("DOM").find(a,"div","noConnectionWrapper");n=b("DOM").find(a,"div","requestErrorWrapper")}}function a(a,c){j&&(j.destroy(),r()),j=a,o=c,s(),k=new(b("SubscriptionsHandler"))(),k.addSubscriptions(j.addListener("beforeshow",q,j),b("Stratcom").listen("m:page:unload",null,r),b("Stratcom").listen("m:story:action-bubble-initialized",null,function(a){a=a.getData();a.menuNubID&&t(b("$")(a.menuNubID),a.wasOpen)}))}function t(a,c){__p&&__p();if(!j||!(j.isShown()||c))return;if(!h||!h.getActionBubble())return;j.hide();c=p(a);if(i==c){c=a.getElementsByClassName("_4s19")[0];b("MTouchClick").click(c)}}function c(a,c,d,e,f){b("DOM").replace(b("$")(c),a),f||t(a,!1)}function d(a){(!i||i.id==a)&&(j&&j.hide(),i=null)}e.exports={init:a,replaceChevronTrigger:c,closeLoadingFlyout:d}}),null);