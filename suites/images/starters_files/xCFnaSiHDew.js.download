if (self.CavalryLogger) { CavalryLogger.start_js(["CP8gq"]); }

__d("MUFICommentTypingSubscriptionController",["SubscriptionsHandler","UFITypingSubscription","destroyOnUnload"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=15*1e3;function h(a){return{friendCount:j(a),otherCount:k(a)}}function i(a){if(a){a=parseInt(a,10);return!isNaN(a)&&isFinite(a)?a:0}else return 0}function j(a){a=a&&a.feedback_typing_subscribe&&a.feedback_typing_subscribe.feedback&&a.feedback_typing_subscribe.feedback.feedback_typers&&a.feedback_typing_subscribe.feedback.feedback_typers.friend_count;return i(a)}function k(a){a=a&&a.feedback_typing_subscribe&&a.feedback_typing_subscribe.feedback&&a.feedback_typing_subscribe.feedback.feedback_typers&&a.feedback_typing_subscribe.feedback.feedback_typers.other_count;return i(a)}a=function(){__p&&__p();function a(a,c){__p&&__p();var d=this;this.$1=null;this.$2=null;this.$3=c;this.$4=new(b("SubscriptionsHandler"))();c=b("UFITypingSubscription").subscribe(String(a),function(a){d.$6(a),d.$7()});c&&this.$4.addSubscriptions(c);this.$5=!!c;b("destroyOnUnload")(this.destroy.bind(this))}var c=a.prototype;c.destroy=function(){this.$8(),this.$4.release()};c.unsubscribe=function(){this.destroy()};c.didSubscribe=function(){return this.$5};c.$7=function(){this.$3(h(this.$1))};c.$8=function(){this.$2&&clearTimeout(this.$2),this.$2=null,this.$1=null};c.$6=function(a){var b=this;this.$8();this.$1=a;this.$2=setTimeout(function(){b.$8(),b.$7()},g)};return a}();e.exports=a}),null);